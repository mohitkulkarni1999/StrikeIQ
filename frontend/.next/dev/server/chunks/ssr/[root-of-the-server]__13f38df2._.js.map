{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///D:/StrikeIQ/frontend/src/api/axios.js"],"sourcesContent":["import axios from \"axios\";\n\nconst api = axios.create({\n  baseURL: \"http://localhost:8000\",\n  withCredentials: true\n});\n\nexport default api;\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,MAAM,MAAM,iKAAK,CAAC,MAAM,CAAC;IACvB,SAAS;IACT,iBAAiB;AACnB;uCAEe"}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///D:/StrikeIQ/frontend/src/contexts/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect, ReactNode } from 'react';\r\nimport api from '../api/axios';\r\nimport { DashboardResponse, isAuthRequired, AuthRequiredData, MarketData } from '@/types/dashboard';\r\n\r\ninterface AuthState {\r\n  isAuthenticated: boolean;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  lastCheck: number;\r\n  mode: 'NORMAL' | 'AUTH';\r\n  loginUrl: string | null;\r\n}\r\n\r\ntype AuthAction =\r\n  | { type: 'AUTH_CHECK_START' }\r\n  | { type: 'AUTH_CHECK_SUCCESS'; isAuthenticated: boolean }\r\n  | { type: 'AUTH_CHECK_ERROR'; error: string }\r\n  | { type: 'AUTH_REQUIRED'; payload: { login_url: string } }\r\n  | { type: 'AUTH_SUCCESS'; isAuthenticated: true };\r\n\r\nconst initialState: AuthState = {\r\n  isAuthenticated: false,\r\n  isLoading: true,\r\n  error: null,\r\n  lastCheck: Date.now(),\r\n  mode: 'NORMAL',\r\n  loginUrl: null,\r\n};\r\n\r\nfunction authReducer(state: AuthState, action: AuthAction): AuthState {\r\n  switch (action.type) {\r\n    case 'AUTH_CHECK_START':\r\n      return { ...state, isLoading: true, error: null };\r\n\r\n    case 'AUTH_CHECK_SUCCESS':\r\n      return {\r\n        ...state,\r\n        isAuthenticated: action.isAuthenticated,\r\n        isLoading: false,\r\n        error: null,\r\n        lastCheck: Date.now(),\r\n      };\r\n\r\n    case 'AUTH_CHECK_ERROR':\r\n      return {\r\n        ...state,\r\n        isAuthenticated: false,\r\n        isLoading: false,\r\n        error: action.error,\r\n        lastCheck: Date.now(),\r\n      };\r\n\r\n    case 'AUTH_REQUIRED':\r\n      return {\r\n        ...state,\r\n        isAuthenticated: false,\r\n        isLoading: false,\r\n        error: 'Authentication required',\r\n        lastCheck: Date.now(),\r\n        mode: 'AUTH',\r\n        loginUrl: action.payload.login_url,\r\n      };\r\n\r\n    case 'AUTH_SUCCESS':\r\n      return {\r\n        ...state,\r\n        isAuthenticated: true,\r\n        isLoading: false,\r\n        error: null,\r\n        lastCheck: Date.now(),\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\ninterface AuthContextType {\r\n  state: AuthState;\r\n  dispatch: React.Dispatch<AuthAction>;\r\n  checkAuth: () => Promise<void>;\r\n  handleAuthRequired: (authData: AuthRequiredData) => void;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\ninterface AuthProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport function AuthProvider({ children }: AuthProviderProps) {\r\n  const [state, dispatch] = useReducer(authReducer, initialState);\r\n\r\n  const checkAuth = async () => {\r\n    // Always check auth status, regardless of current state\r\n    dispatch({ type: 'AUTH_CHECK_START' });\r\n\r\n    try {\r\n      // For now, assume auth is successful if we can reach the WebSocket init endpoint\r\n      // This avoids REST polling and relies on WebSocket connection\r\n      const response = await api.get('/api/ws/init');\r\n      \r\n      if (response.status === 200) {\r\n        dispatch({ type: 'AUTH_CHECK_SUCCESS', isAuthenticated: true });\r\n      } else {\r\n        dispatch({ type: 'AUTH_CHECK_ERROR', error: 'Authentication check failed' });\r\n      }\r\n    } catch (error) {\r\n      dispatch({ type: 'AUTH_CHECK_ERROR', error: error instanceof Error ? error.message : 'Unknown error' });\r\n    }\r\n  };\r\n\r\n  const handleAuthRequired = (authData: AuthRequiredData) => {\r\n    // Prevent redundant setState calls\r\n    if (!state.isAuthenticated && !state.isLoading) {\r\n      return; // Already in auth required state\r\n    }\r\n\r\n    dispatch({ type: 'AUTH_REQUIRED', payload: { login_url: authData.login_url } });\r\n    // Stop any polling here\r\n    console.log('Authentication required, stopping polling');\r\n  };\r\n\r\n  // Listen for auth status updates from polling\r\n  useEffect(() => {\r\n    console.log('üéß AuthContext: Setting up event listeners');\r\n\r\n    const handleAuthRequired = (event: CustomEvent) => {\r\n      console.log('üö´ AuthContext: Received authRequired event', event.detail);\r\n      const { login_url } = event.detail;\r\n      dispatch({ type: 'AUTH_REQUIRED', payload: { login_url } });\r\n    };\r\n\r\n    const handleAuthSuccess = () => {\r\n      console.log('‚úÖ AuthContext: Received authSuccess event');\r\n      dispatch({ type: 'AUTH_SUCCESS', isAuthenticated: true });\r\n    };\r\n\r\n    window.addEventListener('authRequired', handleAuthRequired as EventListener);\r\n    window.addEventListener('authSuccess', handleAuthSuccess);\r\n\r\n    // Initial auth check\r\n    checkAuth();\r\n\r\n    console.log('‚úÖ AuthContext: Event listeners set up and initial check started');\r\n\r\n    return () => {\r\n      console.log('üßπ AuthContext: Cleaning up event listeners');\r\n      window.removeEventListener('authRequired', handleAuthRequired as EventListener);\r\n      window.removeEventListener('authSuccess', handleAuthSuccess);\r\n    };\r\n  }, []);\r\n\r\n  const value: AuthContextType = {\r\n    state,\r\n    dispatch,\r\n    checkAuth,\r\n    handleAuthRequired,\r\n  };\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 212, "column": 0}, "map": {"version":3,"sources":["file:///D:/StrikeIQ/frontend/src/contexts/WebSocketContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useRef, useState, ReactNode } from 'react';\n\ninterface WebSocketContextType {\n  ws: WebSocket | null;\n  isConnected: boolean;\n  connect: (symbol: string, expiry: string) => Promise<void>;\n  disconnect: () => void;\n  lastMessage: any;\n  error: string | null;\n}\n\nconst WebSocketContext = createContext<WebSocketContextType | undefined>(undefined);\n\ninterface WebSocketProviderProps {\n  children: ReactNode;\n}\n\nexport function WebSocketProvider({ children }: WebSocketProviderProps) {\n  const [ws, setWs] = useState<WebSocket | null>(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [lastMessage, setLastMessage] = useState<any>(null);\n  const [error, setError] = useState<string | null>(null);\n  \n  const reconnectTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const reconnectAttemptsRef = useRef(0);\n  const maxReconnectAttempts = 5;\n  const reconnectDelay = 3000; // 3 seconds\n\n  const disconnect = () => {\n    if (reconnectTimeoutRef.current) {\n      clearTimeout(reconnectTimeoutRef.current);\n      reconnectTimeoutRef.current = null;\n    }\n    \n    if (ws) {\n      ws.close();\n      setWs(null);\n    }\n    setIsConnected(false);\n    reconnectAttemptsRef.current = 0;\n  };\n\n  const connect = async (symbol: string, expiry: string) => {\n    try {\n      // First call the WebSocket init API\n      console.log('Initializing WebSocket connection...');\n      const response = await fetch('/api/ws/init', {\n        credentials: 'include'\n      });\n      \n      if (!response.ok) {\n        throw new Error(`WebSocket init failed: ${response.status}`);\n      }\n      \n      console.log('WebSocket init successful, connecting to WebSocket...');\n      \n      // Close existing connection if any\n      disconnect();\n      \n      // Create WebSocket connection\n      const wsUrl = `ws://localhost:8000/ws/live-options/${symbol}?expiry=${encodeURIComponent(expiry)}`;\n      const websocket = new WebSocket(wsUrl);\n      \n      websocket.onopen = () => {\n        console.log('WebSocket connected successfully');\n        setIsConnected(true);\n        setError(null);\n        reconnectAttemptsRef.current = 0;\n      };\n      \n      websocket.onmessage = (event) => {\n        try {\n          const data = JSON.parse(event.data);\n          console.log('WebSocket message received:', data);\n          setLastMessage(data);\n        } catch (err) {\n          console.error('Error parsing WebSocket message:', err);\n        }\n      };\n      \n      websocket.onclose = (event) => {\n        console.log('WebSocket closed:', event.code, event.reason);\n        setIsConnected(false);\n        setWs(null);\n        \n        // Attempt reconnection if not manually closed and under max attempts\n        if (event.code !== 1000 && reconnectAttemptsRef.current < maxReconnectAttempts) {\n          reconnectAttemptsRef.current++;\n          console.log(`Attempting to reconnect in ${reconnectDelay}ms (attempt ${reconnectAttemptsRef.current})`);\n          \n          reconnectTimeoutRef.current = setTimeout(() => {\n            connect(symbol, expiry);\n          }, reconnectDelay);\n        } else if (reconnectAttemptsRef.current >= maxReconnectAttempts) {\n          setError('Max reconnection attempts reached. Please refresh the page.');\n        }\n      };\n      \n      websocket.onerror = (error) => {\n        console.error('WebSocket error:', error);\n        setError('WebSocket connection error');\n      };\n      \n      setWs(websocket);\n      \n    } catch (err) {\n      console.error('Failed to connect WebSocket:', err);\n      setError(err instanceof Error ? err.message : 'Failed to connect WebSocket');\n    }\n  };\n\n  useEffect(() => {\n    return () => {\n      disconnect();\n    };\n  }, []);\n\n  const value: WebSocketContextType = {\n    ws,\n    isConnected,\n    connect,\n    disconnect,\n    lastMessage,\n    error\n  };\n\n  return (\n    <WebSocketContext.Provider value={value}>\n      {children}\n    </WebSocketContext.Provider>\n  );\n}\n\nexport function useWebSocket() {\n  const context = useContext(WebSocketContext);\n  if (context === undefined) {\n    throw new Error('useWebSocket must be used within a WebSocketProvider');\n  }\n  return context;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 333, "column": 0}, "map": {"version":3,"sources":["file:///D:/StrikeIQ/frontend/src/hooks/useLiveMarketData.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { useWebSocket } from '../contexts/WebSocketContext';\n\nexport interface LiveMarketData {\n    symbol: string;\n    spot: number;\n    change?: number;\n    change_percent?: number;\n    analytics: any;\n    intelligence: any;\n    timestamp: string;\n    // Additional engine-specific fields\n    structural_regime?: string;\n    regime_confidence?: number;\n    regime_stability?: number;\n    acceleration_index?: number;\n    regime_dynamics?: any;\n    pin_probability?: number;\n    flow_gamma_interaction?: any;\n    expiry_magnet_analysis?: any;\n    expected_move_data?: any;\n    smart_money_activity?: any;\n    option_chain_intelligence?: any;\n    gamma_pressure_map?: any;\n    alerts?: any[];\n    available_expiries?: string[];\n    // FIX 6: market_bias declared ‚Äî used for VWAP in MarketMetrics\n    market_bias?: {\n        vwap?: number;\n        current_price?: number;\n        pcr?: number;\n        bias_strength?: number;\n    };\n    // Normalized option chain data\n    optionChain?: {\n        symbol: string;\n        spot: number;\n        expiry: string;\n        calls: any[];\n        puts: any[];\n    } | null;\n}\n\ninterface MarketStatus {\n    market_status?: string;\n    websocket_status?: string;\n    server_time?: string;\n    symbol_supported?: string[];\n}\n\ninterface UseLiveMarketDataReturn {\n    data: LiveMarketData | null;\n    status: MarketStatus | null;\n    loading: boolean;\n    error: string | null;\n    mode: 'loading' | 'snapshot' | 'live' | 'error';\n    isConnected: boolean;\n    symbol: string;\n    availableExpiries: string[];\n    lastUpdate: string;\n}\n\n/**\n * WebSocket-only Market Data Hook\n * - Uses global WebSocket context for real-time data\n * - No REST polling - relies entirely on WebSocket\n * - Provides real-time streaming data\n */\nexport function useLiveMarketData(symbol: string, expiry: string | null): UseLiveMarketDataReturn {\n    console.log(\"üîå useLiveMarketData INIT\", { symbol, expiry });\n\n    const [data, setData] = useState<LiveMarketData | null>(null);\n    const [loading, setLoading] = useState<boolean>(false);\n    const [error, setError] = useState<string | null>(null);\n    const [mode, setMode] = useState<'loading' | 'snapshot' | 'live' | 'error'>('loading');\n\n    // Use global WebSocket context\n    const { isConnected, lastMessage, connect, error: wsError } = useWebSocket();\n\n    // Handle WebSocket messages\n    useEffect(() => {\n        if (!lastMessage) return;\n\n        console.log(\"üì® Processing WebSocket message:\", lastMessage);\n\n        try {\n            // Handle different message types\n            if (lastMessage.status === 'connected') {\n                console.log(\"‚úÖ Initial connection message received\");\n                setData(prev => ({\n                    ...prev,\n                    ...lastMessage,\n                    available_expiries: lastMessage.available_expiries || []\n                }));\n                setMode('live');\n                setLoading(false);\n            } else if (lastMessage.status === 'live_update') {\n                console.log(\"üîÑ Live update received\");\n\n                // Transform backend payload to frontend expected shape\n                const transformedData: LiveMarketData = {\n                    ...lastMessage,\n                    // Map intelligence directly\n                    intelligence: lastMessage.intelligence || {},\n                    // Map pin_probability directly  \n                    pin_probability: lastMessage.pin_probability,\n                    // Map optionChain from option_chain_snapshot\n                    optionChain: lastMessage.option_chain_snapshot ? {\n                        symbol: lastMessage.option_chain_snapshot.symbol,\n                        spot: lastMessage.option_chain_snapshot.spot,\n                        expiry: lastMessage.option_chain_snapshot.expiry,\n                        calls: lastMessage.option_chain_snapshot.calls || [],\n                        puts: lastMessage.option_chain_snapshot.puts || []\n                    } : null,\n                    // Extract confidence from intelligence\n                    confidence: lastMessage.intelligence?.bias?.confidence || lastMessage.intelligence?.confidence,\n                    // Map expiries for frontend\n                    expiries: lastMessage.available_expiries || [],\n                    // Ensure required fields\n                    symbol: symbol,\n                    spot: lastMessage.spot || 0,\n                    timestamp: lastMessage.timestamp || new Date().toISOString()\n                };\n\n                setData(prev => ({\n                    ...prev,\n                    ...transformedData\n                }));\n                setMode('live');\n                setLoading(false);\n            } else if (lastMessage.status === 'auth_required') {\n                setError('Authentication required');\n                setMode('error');\n            } else if (lastMessage.status === 'auth_error') {\n                setError('Authentication service unavailable');\n                setMode('error');\n            }\n        } catch (err) {\n            console.error('‚ùå Error parsing WebSocket message:', err);\n            setError('Failed to parse WebSocket message');\n            setMode('error');\n        }\n    }, [lastMessage, symbol]);\n\n    // Handle WebSocket errors\n    useEffect(() => {\n        if (wsError) {\n            console.error('‚ùå WebSocket error from context:', wsError);\n            setError(wsError);\n            setMode('error');\n        }\n    }, [wsError]);\n\n    // Update connection status\n    useEffect(() => {\n        if (isConnected) {\n            console.log('‚úÖ WebSocket connected, setting mode to live');\n            setMode('live');\n            setLoading(false);\n            setError(null);\n        } else {\n            console.log('‚ùå WebSocket disconnected');\n            setMode('loading');\n            setLoading(true);\n        }\n    }, [isConnected]);\n\n    // Initialize connection if not connected and we have symbol/expiry\n    useEffect(() => {\n        if (symbol && expiry && !isConnected && mode === 'loading') {\n            console.log(`üöÄ Initializing WebSocket connection for ${symbol} with expiry ${expiry}`);\n            connect(symbol, expiry);\n        }\n    }, [symbol, expiry, isConnected, mode, connect]);\n\n    return {\n        data,\n        loading,\n        error,\n        mode,\n        isConnected,\n        symbol,\n        availableExpiries: data?.available_expiries || [],\n        lastUpdate: new Date().toISOString(),\n        status: null\n    };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 471, "column": 0}, "map": {"version":3,"sources":["file:///D:/StrikeIQ/frontend/src/components/MarketStatusIndicator.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Clock, Wifi, WifiOff, AlertCircle } from 'lucide-react';\r\nimport api from '../api/axios';\r\n\r\ninterface MarketSession {\r\n  market_status: 'OPEN' | 'CLOSED' | 'PRE_OPEN' | 'OPENING_END' | 'CLOSING' | 'CLOSING_END' | 'HALTED' | 'UNKNOWN';\r\n  engine_mode: 'LIVE' | 'SNAPSHOT' | 'HALTED' | 'OFFLINE';\r\n  last_check?: string;\r\n  is_polling?: boolean;\r\n}\r\n\r\ninterface MarketStatusIndicatorProps {\r\n  className?: string;\r\n}\r\n\r\nconst MarketStatusIndicator: React.FC<MarketStatusIndicatorProps> = ({ className = \"\" }) => {\r\n  const [session, setSession] = useState<MarketSession>({\r\n    market_status: 'UNKNOWN',\r\n    engine_mode: 'OFFLINE'\r\n  });\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const fetchMarketStatus = async () => {\r\n      try {\r\n        const response = await api.get('/api/v1/market/session');\r\n        const result = response.data;\r\n\r\n        if (result.status === 'success') {\r\n          setSession(result.data);\r\n          setError(null);\r\n        } else {\r\n          setError('Failed to fetch market status');\r\n        }\r\n      } catch (err) {\r\n        setError('Network error');\r\n        console.error('Market status fetch error:', err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    // Initial fetch\r\n    fetchMarketStatus();\r\n\r\n    // Poll every 30 seconds\r\n    const interval = setInterval(fetchMarketStatus, 30000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'OPEN':\r\n        return 'bg-green-500/20 text-green-400 border-green-500/40';\r\n      case 'PRE_OPEN':\r\n        return 'bg-yellow-500/20 text-yellow-400 border-yellow-500/40';\r\n      case 'OPENING_END':\r\n        return 'bg-orange-500/20 text-orange-400 border-orange-500/40';\r\n      case 'CLOSING':\r\n        return 'bg-purple-500/20 text-purple-400 border-purple-500/40';\r\n      case 'CLOSING_END':\r\n        return 'bg-indigo-500/20 text-indigo-400 border-indigo-500/40';\r\n      case 'CLOSED':\r\n        return 'bg-red-500/20 text-red-400 border-red-500/40';\r\n      case 'HALTED':\r\n        return 'bg-red-600/20 text-red-500 border-red-600/40';\r\n      default:\r\n        return 'bg-gray-500/20 text-gray-400 border-gray-500/40';\r\n    }\r\n  };\r\n\r\n  const getModeIcon = (mode: string) => {\r\n    switch (mode) {\r\n      case 'LIVE':\r\n        return <Wifi className=\"w-3 h-3\" />;\r\n      case 'SNAPSHOT':\r\n        return <Clock className=\"w-3 h-3\" />;\r\n      case 'HALTED':\r\n        return <AlertCircle className=\"w-3 h-3\" />;\r\n      default:\r\n        return <WifiOff className=\"w-3 h-3\" />;\r\n    }\r\n  };\r\n\r\n  const getModeColor = (mode: string) => {\r\n    switch (mode) {\r\n      case 'LIVE':\r\n        return 'text-green-400';\r\n      case 'SNAPSHOT':\r\n        return 'text-blue-400';\r\n      case 'HALTED':\r\n        return 'text-red-500';\r\n      default:\r\n        return 'text-gray-400';\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className={`flex items-center gap-2 px-2 py-1 bg-card border border-border rounded ${className}`}>\r\n        <div className=\"w-3 h-3 border border-text-secondary border-t-transparent rounded-full animate-spin\"></div>\r\n        <span className=\"text-xs text-text-secondary\">Loading...</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className={`flex items-center gap-2 px-2 py-1 bg-red-500/20 text-red-400 border border-red-500/40 rounded ${className}`}>\r\n        <AlertCircle className=\"w-3 h-3\" />\r\n        <span className=\"text-xs font-mono\">ERROR</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={`flex items-center gap-3 ${className}`}>\r\n      {/* Market Status */}\r\n      <div className={`flex items-center gap-2 px-2 py-1 border rounded font-mono text-xs ${getStatusColor(session.market_status)}`}>\r\n        <span>{session.market_status}</span>\r\n      </div>\r\n\r\n      {/* Engine Mode */}\r\n      <div className={`flex items-center gap-1 ${getModeColor(session.engine_mode)}`}>\r\n        {getModeIcon(session.engine_mode)}\r\n        <span className=\"text-xs font-mono\">{session.engine_mode}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MarketStatusIndicator;\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AAAA;AAAA;AACA;;;;;;;;;AAaA,MAAM,wBAA8D,CAAC,EAAE,YAAY,EAAE,EAAE;IACrF,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAgB;QACpD,eAAe;QACf,aAAa;IACf;IACA,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAgB;IAElD,IAAA,gHAAS,EAAC;QACR,MAAM,oBAAoB;YACxB,IAAI;gBACF,MAAM,WAAW,MAAM,uHAAG,CAAC,GAAG,CAAC;gBAC/B,MAAM,SAAS,SAAS,IAAI;gBAE5B,IAAI,OAAO,MAAM,KAAK,WAAW;oBAC/B,WAAW,OAAO,IAAI;oBACtB,SAAS;gBACX,OAAO;oBACL,SAAS;gBACX;YACF,EAAE,OAAO,KAAK;gBACZ,SAAS;gBACT,QAAQ,KAAK,CAAC,8BAA8B;YAC9C,SAAU;gBACR,WAAW;YACb;QACF;QAEA,gBAAgB;QAChB;QAEA,wBAAwB;QACxB,MAAM,WAAW,YAAY,mBAAmB;QAEhD,OAAO,IAAM,cAAc;IAC7B,GAAG,EAAE;IAEL,MAAM,iBAAiB,CAAC;QACtB,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,MAAM,cAAc,CAAC;QACnB,OAAQ;YACN,KAAK;gBACH,qBAAO,qKAAC,mMAAI;oBAAC,WAAU;;;;;;YACzB,KAAK;gBACH,qBAAO,qKAAC,sMAAK;oBAAC,WAAU;;;;;;YAC1B,KAAK;gBACH,qBAAO,qKAAC,4NAAW;oBAAC,WAAU;;;;;;YAChC;gBACE,qBAAO,qKAAC,gNAAO;oBAAC,WAAU;;;;;;QAC9B;IACF;IAEA,MAAM,eAAe,CAAC;QACpB,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,IAAI,SAAS;QACX,qBACE,qKAAC;YAAI,WAAW,CAAC,uEAAuE,EAAE,WAAW;;8BACnG,qKAAC;oBAAI,WAAU;;;;;;8BACf,qKAAC;oBAAK,WAAU;8BAA8B;;;;;;;;;;;;IAGpD;IAEA,IAAI,OAAO;QACT,qBACE,qKAAC;YAAI,WAAW,CAAC,8FAA8F,EAAE,WAAW;;8BAC1H,qKAAC,4NAAW;oBAAC,WAAU;;;;;;8BACvB,qKAAC;oBAAK,WAAU;8BAAoB;;;;;;;;;;;;IAG1C;IAEA,qBACE,qKAAC;QAAI,WAAW,CAAC,wBAAwB,EAAE,WAAW;;0BAEpD,qKAAC;gBAAI,WAAW,CAAC,mEAAmE,EAAE,eAAe,QAAQ,aAAa,GAAG;0BAC3H,cAAA,qKAAC;8BAAM,QAAQ,aAAa;;;;;;;;;;;0BAI9B,qKAAC;gBAAI,WAAW,CAAC,wBAAwB,EAAE,aAAa,QAAQ,WAAW,GAAG;;oBAC3E,YAAY,QAAQ,WAAW;kCAChC,qKAAC;wBAAK,WAAU;kCAAqB,QAAQ,WAAW;;;;;;;;;;;;;;;;;;AAIhE;uCAEe"}},
    {"offset": {"line": 691, "column": 0}, "map": {"version":3,"sources":["file:///D:/StrikeIQ/frontend/src/components/layout/Navbar.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState } from 'react';\r\nimport { Wifi, WifiOff, Activity, ChevronDown } from 'lucide-react';\r\nimport { useLiveMarketData } from '../../hooks/useLiveMarketData';\r\nimport MarketStatusIndicator from '../MarketStatusIndicator';\r\n\r\nexport default function Navbar() {\r\n  const [symbol, setSymbol] = useState(\"NIFTY\");\r\n  const { mode } = useLiveMarketData(symbol, null);\r\n\r\n  const getLiveStatusBadge = () => {\r\n    if (mode === 'live') {\r\n      return (\r\n        <div className=\"flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium bg-green-500/20 text-green-400 border border-green-500/40\">\r\n          <div className=\"w-2 h-2 rounded-full bg-green-400 animate-pulse\"></div>\r\n          LIVE\r\n        </div>\r\n      );\r\n    } else if (mode === 'snapshot') {\r\n      return (\r\n        <div className=\"flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium bg-yellow-500/20 text-yellow-400 border border-yellow-500/40\">\r\n          <div className=\"w-2 h-2 rounded-full bg-yellow-400 animate-pulse\"></div>\r\n          SNAPSHOT\r\n        </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <div className=\"flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium bg-red-500/20 text-red-400 border border-red-500/40\">\r\n          <div className=\"w-2 h-2 rounded-full bg-red-400\"></div>\r\n          {mode === 'loading' ? 'CONNECTING' : 'DISCONNECTED'}\r\n        </div>\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <nav className=\"bg-card border-b border-border\">\r\n      <div className=\"max-w-[1600px] mx-auto px-6 py-4\">\r\n        <div className=\"flex justify-between items-center\">\r\n          {/* Logo */}\r\n          <div className=\"flex items-center gap-4\">\r\n            <h1 className=\"text-3xl font-black bg-gradient-to-r from-analytics to-bullish bg-clip-text text-transparent transform hover:scale-105 transition-transform cursor-default select-none\">\r\n              StrikeIQ\r\n            </h1>\r\n          </div>\r\n\r\n          {/* Controls */}\r\n          <div className=\"flex items-center gap-6\">\r\n            {/* Symbol Selector */}\r\n            <div className=\"flex items-center gap-3\">\r\n              <input\r\n                type=\"text\"\r\n                value={symbol}\r\n                onChange={(e) => setSymbol(e.target.value.toUpperCase())}\r\n                className=\"bg-background border border-border rounded-lg px-4 py-2 text-text-primary font-mono text-sm focus:outline-none focus:ring-2 focus:ring-analytics w-32\"\r\n                placeholder=\"NIFTY\"\r\n              />\r\n            </div>\r\n\r\n            {/* Market Status Indicator */}\r\n            <MarketStatusIndicator />\r\n\r\n            {/* Live Status Badge */}\r\n            {getLiveStatusBadge()}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </nav>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;;;;;AALA;;;;;AAOe,SAAS;IACtB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAC;IACrC,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,+IAAiB,EAAC,QAAQ;IAE3C,MAAM,qBAAqB;QACzB,IAAI,SAAS,QAAQ;YACnB,qBACE,qKAAC;gBAAI,WAAU;;kCACb,qKAAC;wBAAI,WAAU;;;;;;oBAAwD;;;;;;;QAI7E,OAAO,IAAI,SAAS,YAAY;YAC9B,qBACE,qKAAC;gBAAI,WAAU;;kCACb,qKAAC;wBAAI,WAAU;;;;;;oBAAyD;;;;;;;QAI9E,OAAO;YACL,qBACE,qKAAC;gBAAI,WAAU;;kCACb,qKAAC;wBAAI,WAAU;;;;;;oBACd,SAAS,YAAY,eAAe;;;;;;;QAG3C;IACF;IAEA,qBACE,qKAAC;QAAI,WAAU;kBACb,cAAA,qKAAC;YAAI,WAAU;sBACb,cAAA,qKAAC;gBAAI,WAAU;;kCAEb,qKAAC;wBAAI,WAAU;kCACb,cAAA,qKAAC;4BAAG,WAAU;sCAAyK;;;;;;;;;;;kCAMzL,qKAAC;wBAAI,WAAU;;0CAEb,qKAAC;gCAAI,WAAU;0CACb,cAAA,qKAAC;oCACC,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK,CAAC,WAAW;oCACrD,WAAU;oCACV,aAAY;;;;;;;;;;;0CAKhB,qKAAC,+IAAqB;;;;;4BAGrB;;;;;;;;;;;;;;;;;;;;;;;AAMb"}},
    {"offset": {"line": 883, "column": 0}, "map": {"version":3,"sources":["file:///D:/StrikeIQ/frontend/src/components/AuthScreen.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { useRouter } from 'next/router';\r\nimport { AuthRequiredData } from '../types/dashboard';\r\nimport api from '../api/axios';\r\n\r\ninterface AuthScreenProps {\r\n  authData: AuthRequiredData;\r\n}\r\n\r\nfunction AuthScreen({ authData }: AuthScreenProps) {\r\n  const { checkAuth } = useAuth();\r\n  const router = useRouter();\r\n  const [isChecking, setIsChecking] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // Check authentication status on mount\r\n    const checkAuthStatus = async () => {\r\n      try {\r\n        const response = await api.get('/api/v1/auth/status');\r\n        const result = response.data;\r\n\r\n        if (result.authenticated === true) {\r\n          router.push('/');\r\n        } else {\r\n          setIsChecking(false);\r\n        }\r\n      } catch (error) {\r\n        setIsChecking(false);\r\n      }\r\n    };\r\n\r\n    checkAuthStatus();\r\n  }, [router]);\r\n\r\n  const handleReconnect = () => {\r\n    // Stop any existing polling\r\n    const event = new CustomEvent('stopPolling');\r\n    window.dispatchEvent(event);\r\n\r\n    // SECURITY: No frontend state generation\r\n    // Backend will generate and manage state\r\n    window.location.href = authData.login_url;\r\n  };\r\n\r\n  if (isChecking) {\r\n    return (\r\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\r\n        <div className=\"text-center text-white\">\r\n          <div className=\"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\r\n          <p>Checking authentication status...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background flex items-center justify-center\">\r\n      <div className=\"max-w-md w-full mx-4\">\r\n        <div className=\"glass-morphism rounded-2xl p-8 text-center\">\r\n          {/* Icon */}\r\n          <div className=\"w-20 h-20 bg-orange-500 rounded-full flex items-center justify-center mx-auto mb-6\">\r\n            <svg\r\n              className=\"w-10 h-10 text-white\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"\r\n              />\r\n            </svg>\r\n          </div>\r\n\r\n          {/* Title */}\r\n          <h1 className=\"text-3xl font-bold text-white mb-2\">\r\n            Authentication Required\r\n          </h1>\r\n\r\n          {/* Message */}\r\n          <p className=\"text-gray-300 mb-8 leading-relaxed\">\r\n            {authData.message}\r\n          </p>\r\n\r\n          {/* Status Badge */}\r\n          <div className=\"inline-flex items-center gap-2 bg-orange-500/20 text-orange-400 px-4 py-2 rounded-full mb-8\">\r\n            <div className=\"w-2 h-2 bg-orange-400 rounded-full animate-pulse\"></div>\r\n            <span className=\"text-sm font-medium\">Session Expired</span>\r\n          </div>\r\n\r\n          {/* Reconnect Button */}\r\n          <button\r\n            onClick={handleReconnect}\r\n            className=\"w-full bg-orange-500 hover:bg-orange-600 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-orange-500/25\"\r\n          >\r\n            <div className=\"flex items-center justify-center gap-3\">\r\n              <svg\r\n                className=\"w-5 h-5\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\r\n                />\r\n              </svg>\r\n              <span>Get Authorization</span>\r\n            </div>\r\n          </button>\r\n\r\n          {/* Help Text */}\r\n          <div className=\"mt-6 text-sm text-gray-400\">\r\n            <p>You'll be redirected to the authorization server.</p>\r\n            <p className=\"mt-1\">After authorization, you'll be returned here automatically.</p>\r\n          </div>\r\n\r\n          {/* Timestamp */}\r\n          <div className=\"mt-8 pt-6 border-t border-gray-700\">\r\n            <p className=\"text-xs text-gray-500\">\r\n              Detected at: {new Date(authData.timestamp).toLocaleString()}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default React.memo(AuthScreen);\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;;;;;;AAMA,SAAS,WAAW,EAAE,QAAQ,EAAmB;IAC/C,MAAM,EAAE,SAAS,EAAE,GAAG,IAAA,mIAAO;IAC7B,MAAM,SAAS,IAAA,oIAAS;IACxB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,+GAAQ,EAAC;IAE7C,IAAA,gHAAS,EAAC;QACR,uCAAuC;QACvC,MAAM,kBAAkB;YACtB,IAAI;gBACF,MAAM,WAAW,MAAM,uHAAG,CAAC,GAAG,CAAC;gBAC/B,MAAM,SAAS,SAAS,IAAI;gBAE5B,IAAI,OAAO,aAAa,KAAK,MAAM;oBACjC,OAAO,IAAI,CAAC;gBACd,OAAO;oBACL,cAAc;gBAChB;YACF,EAAE,OAAO,OAAO;gBACd,cAAc;YAChB;QACF;QAEA;IACF,GAAG;QAAC;KAAO;IAEX,MAAM,kBAAkB;QACtB,4BAA4B;QAC5B,MAAM,QAAQ,IAAI,YAAY;QAC9B,OAAO,aAAa,CAAC;QAErB,yCAAyC;QACzC,yCAAyC;QACzC,OAAO,QAAQ,CAAC,IAAI,GAAG,SAAS,SAAS;IAC3C;IAEA,IAAI,YAAY;QACd,qBACE,qKAAC;YAAI,WAAU;sBACb,cAAA,qKAAC;gBAAI,WAAU;;kCACb,qKAAC;wBAAI,WAAU;;;;;;kCACf,qKAAC;kCAAE;;;;;;;;;;;;;;;;;IAIX;IAEA,qBACE,qKAAC;QAAI,WAAU;kBACb,cAAA,qKAAC;YAAI,WAAU;sBACb,cAAA,qKAAC;gBAAI,WAAU;;kCAEb,qKAAC;wBAAI,WAAU;kCACb,cAAA,qKAAC;4BACC,WAAU;4BACV,MAAK;4BACL,QAAO;4BACP,SAAQ;sCAER,cAAA,qKAAC;gCACC,eAAc;gCACd,gBAAe;gCACf,aAAa;gCACb,GAAE;;;;;;;;;;;;;;;;kCAMR,qKAAC;wBAAG,WAAU;kCAAqC;;;;;;kCAKnD,qKAAC;wBAAE,WAAU;kCACV,SAAS,OAAO;;;;;;kCAInB,qKAAC;wBAAI,WAAU;;0CACb,qKAAC;gCAAI,WAAU;;;;;;0CACf,qKAAC;gCAAK,WAAU;0CAAsB;;;;;;;;;;;;kCAIxC,qKAAC;wBACC,SAAS;wBACT,WAAU;kCAEV,cAAA,qKAAC;4BAAI,WAAU;;8CACb,qKAAC;oCACC,WAAU;oCACV,MAAK;oCACL,QAAO;oCACP,SAAQ;8CAER,cAAA,qKAAC;wCACC,eAAc;wCACd,gBAAe;wCACf,aAAa;wCACb,GAAE;;;;;;;;;;;8CAGN,qKAAC;8CAAK;;;;;;;;;;;;;;;;;kCAKV,qKAAC;wBAAI,WAAU;;0CACb,qKAAC;0CAAE;;;;;;0CACH,qKAAC;gCAAE,WAAU;0CAAO;;;;;;;;;;;;kCAItB,qKAAC;wBAAI,WAAU;kCACb,cAAA,qKAAC;4BAAE,WAAU;;gCAAwB;gCACrB,IAAI,KAAK,SAAS,SAAS,EAAE,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOvE;qDAEe,8GAAK,CAAC,IAAI,CAAC"}},
    {"offset": {"line": 1150, "column": 0}, "map": {"version":3,"sources":["file:///D:/StrikeIQ/frontend/src/components/AppBootstrapGuard.tsx"],"sourcesContent":["import { useAuth } from \"../contexts/AuthContext\";\r\nimport AuthScreen from \"./AuthScreen\";\r\n\r\nexport default function AppBootstrapGuard({ children }: { children: React.ReactNode }) {\r\n    const { state } = useAuth();\r\n    const { isLoading, mode, loginUrl } = state;\r\n\r\n    console.log(\"üõ°Ô∏è AppBootstrapGuard State:\", { isLoading, mode, hasLoginUrl: !!loginUrl });\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"w-screen h-screen flex flex-col items-center justify-center bg-slate-900 text-white\">\r\n                <div className=\"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-6\"></div>\r\n                <div className=\"space-y-2 text-center\">\r\n                    <p className=\"text-xl font-bold tracking-widest text-blue-400\">STRIKE IQ</p>\r\n                    <p className=\"text-slate-400 font-mono text-sm animate-pulse uppercase\">Synchronizing Neural Market State...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (mode === 'AUTH' && loginUrl) {\r\n        return (\r\n            <AuthScreen\r\n                authData={{\r\n                    session_type: 'AUTH_REQUIRED',\r\n                    mode: 'AUTH',\r\n                    login_url: loginUrl,\r\n                    message: 'Your Upstox session has expired or requires authorization. Please reconnect to continue receiving live market intelligence.',\r\n                    timestamp: new Date().toISOString()\r\n                }}\r\n            />\r\n        );\r\n    }\r\n\r\n    return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;;;;;;AAEe,SAAS,kBAAkB,EAAE,QAAQ,EAAiC;IACjF,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,mIAAO;IACzB,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG;IAEtC,QAAQ,GAAG,CAAC,gCAAgC;QAAE;QAAW;QAAM,aAAa,CAAC,CAAC;IAAS;IAEvF,IAAI,WAAW;QACX,qBACI,qKAAC;YAAI,WAAU;;8BACX,qKAAC;oBAAI,WAAU;;;;;;8BACf,qKAAC;oBAAI,WAAU;;sCACX,qKAAC;4BAAE,WAAU;sCAAkD;;;;;;sCAC/D,qKAAC;4BAAE,WAAU;sCAA2D;;;;;;;;;;;;;;;;;;IAIxF;IAEA,IAAI,SAAS,UAAU,UAAU;QAC7B,qBACI,qKAAC,oIAAU;YACP,UAAU;gBACN,cAAc;gBACd,MAAM;gBACN,WAAW;gBACX,SAAS;gBACT,WAAW,IAAI,OAAO,WAAW;YACrC;;;;;;IAGZ;IAEA,qBAAO;kBAAG;;AACd"}},
    {"offset": {"line": 1242, "column": 0}, "map": {"version":3,"sources":["file:///D:/StrikeIQ/frontend/src/pages/_app.tsx"],"sourcesContent":["import type { AppProps } from 'next/app';\r\nimport { useEffect } from 'react';\r\nimport { AuthProvider } from '@/contexts/AuthContext';\r\nimport { WebSocketProvider } from '@/contexts/WebSocketContext';\r\nimport Navbar from '@/components/layout/Navbar';\r\nimport AppBootstrapGuard from '@/components/AppBootstrapGuard';\r\nimport '@/styles/globals.css';\r\n\r\nfunction MyApp({ Component, pageProps }: AppProps) {\r\n  useEffect(() => {\r\n    // Apply dark mode by default\r\n    document.documentElement.classList.add('dark');\r\n\r\n    // AUTH EXPIRY LISTENER\r\n    const handleAuthExpired = () => {\r\n      console.warn('üîê Auth expired event received - redirecting to /auth')\r\n      // Clear any stored auth data\r\n      localStorage.removeItem(\"upstox_auth\")\r\n      sessionStorage.removeItem(\"upstox_auth\")\r\n\r\n      // Redirect to auth screen\r\n      window.location.href = \"/auth\"\r\n    }\r\n\r\n    // Add global event listener for auth expiry\r\n    window.addEventListener(\"auth-expired\", handleAuthExpired)\r\n\r\n    // üîç GLOBAL REST CALL INTERCEPTOR FOR AUDIT\r\n    const originalFetch = window.fetch;\r\n    window.fetch = async (...args) => {\r\n      console.log(\"üåê REST CALL DETECTED:\", args[0]);\r\n      console.log(\"üåê REST METHOD:\", args[1]?.method || 'GET');\r\n      console.log(\"üåê REST TIMESTAMP:\", new Date().toISOString());\r\n\r\n      const start = performance.now();\r\n      const response = await originalFetch(...args);\r\n      const duration = performance.now() - start;\r\n\r\n      console.log(\"üåê REST STATUS:\", response.status);\r\n      console.log(\"üåê REST DURATION:\", `${duration.toFixed(2)}ms`);\r\n\r\n      return response;\r\n    };\r\n\r\n    // üîç AXIOS INTERCEPTOR (if axios is used)\r\n    if (typeof window !== 'undefined' && (window as any).axios) {\r\n      (window as any).axios.interceptors.request.use((config: any) => {\r\n        console.log(\"üåê AXIOS REST CALL:\", config.url);\r\n        console.log(\"üåê AXIOS METHOD:\", config.method);\r\n        return config;\r\n      });\r\n    }\r\n\r\n    console.log(\"üîç REST/WINDOW INTERCEPTORS INSTALLED\");\r\n\r\n    // Cleanup on unmount\r\n    return () => {\r\n      window.removeEventListener(\"auth-expired\", handleAuthExpired)\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <AuthProvider>\r\n      <WebSocketProvider>\r\n        <AppBootstrapGuard>\r\n          <div className=\"min-h-screen bg-background text-text-primary\">\r\n            <Navbar />\r\n            <Component {...pageProps} />\r\n          </div>\r\n        </AppBootstrapGuard>\r\n      </WebSocketProvider>\r\n    </AuthProvider>\r\n  );\r\n}\r\n\r\nexport default MyApp;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AAGA,SAAS,MAAM,EAAE,SAAS,EAAE,SAAS,EAAY;IAC/C,IAAA,gHAAS,EAAC;QACR,6BAA6B;QAC7B,SAAS,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC;QAEvC,uBAAuB;QACvB,MAAM,oBAAoB;YACxB,QAAQ,IAAI,CAAC;YACb,6BAA6B;YAC7B,aAAa,UAAU,CAAC;YACxB,eAAe,UAAU,CAAC;YAE1B,0BAA0B;YAC1B,OAAO,QAAQ,CAAC,IAAI,GAAG;QACzB;QAEA,4CAA4C;QAC5C,OAAO,gBAAgB,CAAC,gBAAgB;QAExC,4CAA4C;QAC5C,MAAM,gBAAgB,OAAO,KAAK;QAClC,OAAO,KAAK,GAAG,OAAO,GAAG;YACvB,QAAQ,GAAG,CAAC,0BAA0B,IAAI,CAAC,EAAE;YAC7C,QAAQ,GAAG,CAAC,mBAAmB,IAAI,CAAC,EAAE,EAAE,UAAU;YAClD,QAAQ,GAAG,CAAC,sBAAsB,IAAI,OAAO,WAAW;YAExD,MAAM,QAAQ,YAAY,GAAG;YAC7B,MAAM,WAAW,MAAM,iBAAiB;YACxC,MAAM,WAAW,YAAY,GAAG,KAAK;YAErC,QAAQ,GAAG,CAAC,mBAAmB,SAAS,MAAM;YAC9C,QAAQ,GAAG,CAAC,qBAAqB,GAAG,SAAS,OAAO,CAAC,GAAG,EAAE,CAAC;YAE3D,OAAO;QACT;QAEA,0CAA0C;QAC1C;;QAQA,QAAQ,GAAG,CAAC;QAEZ,qBAAqB;QACrB,OAAO;YACL,OAAO,mBAAmB,CAAC,gBAAgB;QAC7C;IACF,GAAG,EAAE;IAEL,qBACE,qKAAC,wIAAY;kBACX,cAAA,qKAAC,kJAAiB;sBAChB,cAAA,qKAAC,2IAAiB;0BAChB,cAAA,qKAAC;oBAAI,WAAU;;sCACb,qKAAC,0IAAM;;;;;sCACP,qKAAC;4BAAW,GAAG,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMpC;uCAEe"}}]
}