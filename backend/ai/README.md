# AI Learning System for StrikeIQ

This folder contains the Experience-Based AI Learning System that:

1. **Stores prediction signals** generated by option formulas (F01-F24)
2. **Automatically checks outcomes** after 5 minutes using live market data
3. **Marks predictions** as WIN/LOSS/NEUTRAL based on price movement
4. **Updates experience statistics** for each formula
5. **Maintains learning memory** in PostgreSQL

## Files

- **ai_db.py**: PostgreSQL connection and database operations
- **prediction_service.py**: Store and retrieve predictions
- **outcome_checker.py**: Check prediction outcomes using live market data
- **experience_updater.py**: Update formula experience statistics
- **scheduler.py**: APScheduler for automated outcome checking
- **formula_integrator.py**: Easy integration point for formula signals

## Database Tables

- **formula_master**: Master list of formulas (F01-F24)
- **prediction_log**: All prediction signals with timestamps
- **outcome_log**: Prediction outcomes and results
- **formula_experience**: Cumulative statistics for each formula

## Usage

### For Formula Integration

When any formula (F01-F24) generates a BUY/SELL signal:

```python
from ai.formula_integrator import store_formula_signal

# Store the signal
success = store_formula_signal(
    formula_id='F01',
    signal='BUY',
    confidence=0.85,
    current_price=19500.50
)
```

### For Performance Tracking

```python
from ai.formula_integrator import formula_integrator

# Get formula performance
performance = formula_integrator.get_formula_performance('F01')
print(f"Success rate: {performance['success_rate']:.2f}%")
```

## Automated Learning

The system automatically:
1. Checks outcomes every 1 minute via scheduler
2. Fetches current NIFTY price from Upstox API
3. Calculates WIN/LOSS/NEUTRAL based on Â±0.3% movement
4. Updates formula experience statistics
5. Maintains learning memory for future improvements

## Integration with Main App

The AI scheduler starts automatically when the FastAPI app starts:
- Integrated in `main.py` lifespan manager
- Starts on app startup
- Stops gracefully on app shutdown
- Logs all activities for monitoring
